<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diet Planner - Enhanced</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; 
            color: #2c3e50;
            line-height: 1.6;
        }
        
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px;
            min-height: 100vh;
        }
        
        .header { 
            text-align: center; 
            margin-bottom: 30px; 
            background: rgba(255, 255, 255, 0.95); 
            padding: 30px; 
            border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); 
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .header h1 { 
            color: #667eea; 
            font-size: 2.5rem; 
            margin-bottom: 10px; 
            font-weight: 700; 
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p { 
            color: #64748b; 
            font-size: 1.1rem; 
            font-weight: 400;
        }
        
        .form-section { 
            background: rgba(255, 255, 255, 0.95); 
            padding: 40px; 
            border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); 
            backdrop-filter: blur(10px); 
            margin-bottom: 30px; 
            transition: all 0.5s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .form-section.hidden { 
            opacity: 0; 
            transform: translateY(-20px); 
            pointer-events: none; 
        }
        
        .form-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 25px; 
            margin-bottom: 30px; 
        }
        
        .form-group { 
            display: flex; 
            flex-direction: column; 
        }
        
        .form-group label { 
            font-weight: 600; 
            color: #374151; 
            margin-bottom: 8px; 
            font-size: 0.95rem; 
        }
        
        .form-group select, .form-group input { 
            padding: 14px 16px; 
            border: 2px solid #e5e7eb; 
            border-radius: 12px; 
            font-size: 1rem; 
            transition: all 0.3s ease; 
            background: white;
            font-family: inherit;
        }
        
        .form-group select:focus, .form-group input:focus { 
            outline: none; 
            border-color: #667eea; 
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }
        
        .form-group.error input, .form-group.error select { 
            border-color: #ef4444; 
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }
        
        .error-message { 
            color: #ef4444; 
            font-size: 0.85rem; 
            margin-top: 4px; 
            font-weight: 500;
        }
        
        .btn { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            border: none; 
            padding: 16px 32px; 
            border-radius: 12px; 
            font-size: 1.1rem; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            font-family: inherit;
        }
        
        .btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4); 
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-secondary { 
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); 
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3); 
        }
        
        .btn-secondary:hover { 
            box-shadow: 0 6px 20px rgba(245, 158, 11, 0.4); 
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid #667eea;
            color: #667eea;
            box-shadow: none;
        }
        
        .btn-outline:hover {
            background: #667eea;
            color: white;
        }
        
        .btn:disabled { 
            opacity: 0.6; 
            cursor: not-allowed; 
            transform: none; 
        }
        
        .results-section { 
            display: none; 
            background: rgba(255, 255, 255, 0.95); 
            padding: 30px; 
            border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); 
            backdrop-filter: blur(10px); 
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: slideInUp 0.6s ease-out;
        }
        
        @keyframes slideInUp { 
            from { 
                opacity: 0; 
                transform: translateY(30px);
            } 
            to { 
                opacity: 1; 
                transform: translateY(0);
            } 
        }
        
        .meal-plan-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 20px 0; 
            background: white; 
            border-radius: 15px; 
            overflow: hidden; 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08); 
            font-size: 0.95rem; 
        }
        
        .meal-plan-table th { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 16px 12px; 
            text-align: left; 
            font-weight: 600; 
            font-size: 0.9rem; 
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .meal-plan-table td { 
            padding: 16px 12px; 
            border-bottom: 1px solid #f1f5f9; 
            font-size: 0.9rem;
            vertical-align: top;
        }
        
        .meal-plan-table tr:hover { 
            background: #f8fafc; 
        }
        
        .meal-plan-table tr:last-child td {
            border-bottom: none;
        }
        
        .meal-item { 
            font-weight: 600; 
            color: #374151; 
            margin-bottom: 4px;
        }
        
        .calorie-info { 
            font-size: 0.85rem; 
            color: #667eea; 
            font-weight: 500;
            margin-bottom: 2px;
        }
        
        .serving-info {
            font-size: 0.8rem;
            color: #6b7280;
            margin-bottom: 4px;
        }
        
        .nutrient-info {
            font-size: 0.75rem;
            color: #9ca3af;
        }
        
        .charts-container { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 25px; 
            margin: 30px 0; 
        }
        
        .chart-card { 
            background: white; 
            padding: 25px; 
            border-radius: 16px; 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08); 
            border: 1px solid rgba(241, 245, 249, 0.8);
        }
        
        .chart-card h3 { 
            color: #374151; 
            margin-bottom: 20px; 
            text-align: center; 
            font-size: 1.1rem; 
            font-weight: 600;
        }
        
        .back-btn { 
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%); 
            color: white; 
            border: none; 
            padding: 12px 20px; 
            border-radius: 10px; 
            font-size: 0.95rem; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            margin: 20px auto 0; 
            display: block;
            box-shadow: 0 4px 15px rgba(107, 114, 128, 0.3); 
        }
        
        .back-btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 6px 20px rgba(107, 114, 128, 0.4); 
        }
        
        .loading { 
            display: none; 
            text-align: center; 
            padding: 40px 20px; 
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            margin-top: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .spinner { 
            border: 4px solid #f1f5f9; 
            border-top: 4px solid #667eea; 
            border-radius: 50%; 
            width: 50px; 
            height: 50px; 
            animation: spin 1s linear infinite; 
            margin: 0 auto 20px; 
        }
        
        @keyframes spin { 
            0% { transform: rotate(0deg); } 
            100% { transform: rotate(360deg); } 
        }
        
        .export-buttons { 
            display: flex; 
            gap: 15px; 
            margin: 25px 0; 
            flex-wrap: wrap; 
            justify-content: center; 
        }
        
        .integration-buttons { 
            display: flex; 
            gap: 15px; 
            margin: 15px 0; 
            flex-wrap: wrap; 
            justify-content: center; 
        }
        
        .section-title {
            color: #374151;
            font-size: 1.3rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .results-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 16px;
            border: 1px solid #e5e7eb;
        }
        
        .results-title {
            color: #667eea;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        .summary-card {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #bae6fd;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .summary-title {
            color: #374151;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .summary-item {
            text-align: center;
            padding: 12px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
        }
        
        .summary-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #667eea;
        }
        
        .summary-label {
            font-size: 0.85rem;
            color: #6b7280;
            margin-top: 4px;
        }
        
        @media (max-width: 768px) {
            .container { padding: 15px; }
            .header h1 { font-size: 2rem; }
            .form-section, .results-section { padding: 20px; }
            .form-grid { grid-template-columns: 1fr; gap: 15px; }
            .charts-container { grid-template-columns: 1fr; }
            .meal-plan-table { font-size: 0.85rem; }
            .meal-plan-table th, .meal-plan-table td { padding: 12px 8px; }
            .chart-card { padding: 15px; }
            .export-buttons, .integration-buttons { 
                flex-direction: column; 
                align-items: center;
            }
            .btn {
                width: 100%;
                max-width: 280px;
            }
            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .meal-plan-table { font-size: 0.8rem; }
            .chart-card canvas { max-width: 100%; height: 200px; }
            .summary-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Additional improvements */
        .form-section h2 {
            color: #374151;
            text-align: center;
            margin-bottom: 25px;
            font-weight: 700;
            font-size: 1.3rem;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .loading p {
            color: #6b7280;
            font-size: 1.1rem;
            font-weight: 500;
        }

        /* Smooth transitions */
        .form-group input:hover, .form-group select:hover {
            border-color: #d1d5db;
        }

        /* Better focus states */
        .btn:focus {
            outline: 2px solid #667eea;
            outline-offset: 2px;
        }
        
        /* Accessibility improvements */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>🍽️ Advanced Diet Planner</h1>
        <p>Create your personalized meal plan based on your comprehensive health profile</p>
    </div>

    <div class="form-section" id="formSection">
        <h2>Complete Your Health Profile</h2>
        <form id="dietForm">
            <div class="form-grid">
                <!-- Basic Info -->
                <div class="form-group">
                    <label for="age">Age *</label>
                    <input type="number" id="age" min="13" max="120" required placeholder="Enter your age">
                    <div class="error-message" id="age-error"></div>
                </div>
                
                <div class="form-group">
                    <label for="gender">Gender *</label>
                    <select id="gender" required>
                        <option value="">Select Gender</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                    </select>
                    <div class="error-message" id="gender-error"></div>
                </div>

                <div class="form-group">
                    <label for="height">Height (cm) *</label>
                    <input type="number" id="height" min="100" max="250" required placeholder="e.g., 175">
                    <div class="error-message" id="height-error"></div>
                </div>

                <div class="form-group">
                    <label for="weight">Weight (kg) *</label>
                    <input type="number" id="weight" min="30" max="300" step="0.1" required placeholder="e.g., 70.5">
                    <div class="error-message" id="weight-error"></div>
                </div>

                <!-- Goals -->
                <div class="form-group">
                    <label for="goal">Health Goal *</label>
                    <select id="goal" required>
                        <option value="">Select Goal</option>
                        <option value="loss">Weight Loss</option>
                        <option value="gain">Weight Gain</option>
                        <option value="maintain">Maintain Weight</option>
                        <option value="muscle">Muscle Gain</option>
                    </select>
                    <div class="error-message" id="goal-error"></div>
                </div>

                <!-- Diet Preferences -->
                <div class="form-group">
                    <label for="dietType">Dietary Preference *</label>
                    <select id="dietType" required>
                        <option value="">Select Diet Type</option>
                        <option value="Regular">Regular (Omnivore)</option>
                        <option value="Vegetarian">Vegetarian</option>
                        <option value="Vegan">Vegan</option>
                        <option value="Keto">Ketogenic</option>
                        <option value="Pescatarian">Pescatarian</option>
                        <option value="Low-carb">Low-Carb</option>
                    </select>
                    <div class="error-message" id="dietType-error"></div>
                </div>

                <!-- Region -->
                <div class="form-group">
                    <label for="region">Region *</label>
                    <select id="region" required>
                        <option value="">Select Region</option>
                        <option value="USA">USA</option>
                        <option value="Europe">Europe</option>
                        <option value="India">India</option>
                        <option value="Middle East">Middle East</option>
                        <option value="Other">Other</option>
                    </select>
                    <div class="error-message" id="region-error"></div>
                </div>

                <!-- Activity Level -->
                <div class="form-group">
                    <label for="activityLevel">Activity Level *</label>
                    <select id="activityLevel" required>
                        <option value="">Select Activity Level</option>
                        <option value="low">Low (Sedentary)</option>
                        <option value="moderate">Moderate (Light exercise)</option>
                        <option value="high">High (Regular exercise)</option>
                        <option value="very-high">Very High (Intense exercise)</option>
                    </select>
                    <div class="error-message" id="activityLevel-error"></div>
                </div>

                <!-- Target Calories -->
                <div class="form-group">
                    <label for="targetCalories">Target Daily Calories (optional)</label>
                    <input type="number" id="targetCalories" min="800" max="5000" placeholder="Auto-calculated if empty">
                    <div class="error-message" id="targetCalories-error"></div>
                </div>
            </div>
            
            <div style="text-align: center;">
                <button type="submit" class="btn" id="generateBtn">
                    <span id="generateBtnText">Generate My Meal Plan</span>
                </button>
            </div>
        </form>
    </div>

    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>Creating your personalized meal plan...</p>
    </div>

    <div class="results-section" id="resultsSection">
        <div class="results-header">
            <h2 class="results-title">Your 7-Day Meal Plan</h2>
            
            <div class="btn-group integration-buttons">
                <button class="btn" onclick="sendPlanToTracker()">📊 Send to Diet Tracker</button>
                <button class="btn-outline" onclick="goToTracker()">📱 Open Diet Tracker</button>
            </div>
            
            <div class="btn-group export-buttons">
                <button class="btn-secondary" onclick="downloadCSV()">📄 Download CSV</button>
                <button class="btn-secondary" onclick="downloadPDF()">📑 Download PDF</button>
            </div>
        </div>
        
        <div id="mealPlanContainer">
            <div id="summaryCard"></div>
            <div id="mealPlanTable"></div>
            <div class="charts-container">
                <div class="chart-card">
                    <h3>Daily Calorie Distribution</h3>
                    <canvas id="calorieChart" width="400" height="200"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Weekly Macros Breakdown</h3>
                    <canvas id="macrosChart" width="400" height="200"></canvas>
                </div>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 30px;">
            <button class="back-btn" onclick="goBackToForm()">← Edit My Profile</button>
        </div>
    </div>
</div>

<script src="planner.js"></script>
</body>
</html>